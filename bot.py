import os
from telegram import (
    Update,
    ReplyKeyboardMarkup,
    InlineKeyboardButton,
    InlineKeyboardMarkup,
)
from telegram.ext import (
    ApplicationBuilder,
    CommandHandler,
    MessageHandler,
    CallbackQueryHandler,
    ContextTypes,
    filters,
)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ê¸°ë³¸ ì„¤ì • â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TOKEN = os.getenv("BOT_TOKEN")
APP_URL = (os.getenv("APP_URL") or "").strip()
CHANNEL_ID = (os.getenv("CHANNEL_ID") or "").strip()  # ì˜ˆ: @sportpicck ë˜ëŠ” -100xxxxxxxxxxxx

# ì±„ë„/ë¯¸ë¦¬ë³´ê¸° ê³µí†µìœ¼ë¡œ ì‚¬ìš©í•  ì„¤ëª… í…ìŠ¤íŠ¸
MENU_CAPTION = (
    "ğŸ“Œ ìŠ¤í¬ì¸  ì •ë³´&ë¶„ì„ ê³µìœ ë°© ë©”ë‰´ ì•ˆë‚´\n\n"
    "1ï¸âƒ£ ì‹¤ì‹œê°„ ë¬´ë£Œ ì¤‘ê³„ - GOAT-TV ë¼ì´ë¸Œ ì¤‘ê³„ ë°”ë¡œê°€ê¸°\n"
    "2ï¸âƒ£ 11.14 ê²½ê¸° ë¶„ì„í”½ - ì¢…ëª©ë³„ë¡œ 11ì›” 14ì¼ ê²½ê¸° ë¶„ì„ì„ í™•ì¸í•˜ì„¸ìš”\n"
    "3ï¸âƒ£ ìŠ¤í¬ì¸  ë‰´ìŠ¤ ìš”ì•½ - ì£¼ìš” ì´ìŠˆ & ë‰´ìŠ¤ ìš”ì•½ ì •ë¦¬\n\n"
    "ì•„ë˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ ì›í•˜ëŠ” ë©”ë‰´ë¥¼ ì„ íƒí•˜ì„¸ìš” ğŸ‘‡"
)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ë¶„ì„/ë‰´ìŠ¤ ë°ì´í„° (ì˜ˆì‹œ) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ANALYSIS_DATA = {
    "ì¶•êµ¬": [
        {
            "id": "soccer_1",
            "title": "INTL - ì¼ë³¸ vs ê°€ë‚˜",
            "summary": """ğŸ“Œ ì¼ë³¸ vs ê°€ë‚˜ ë¶„ì„ ìš”ì•½

âœ”ï¸ íŒ€ ë¶„ìœ„ê¸° & ìµœê·¼ íë¦„
ì¼ë³¸: ì¤‘ì› ì¡°í•© ì•ˆì •ì„±ì´ í¬ê²Œ ì˜¬ë¼ì˜¨ ìƒíƒœ. ì—”ë„â€“ì¹´ë§ˆë‹¤â€“íƒ€ë‚˜ì¹´ ë¼ì¸ì´ ì™„ì „íˆ ë³µê·€í•˜ë©° ê²½ê¸° ìš´ì˜ì˜ ì™„ì„±ë„ê°€ ë†’ì•„ì¡Œê³ , ì†Œì†íŒ€ì—ì„œë„ ê¾¸ì¤€íˆ ì¶œì „í•´ ê²½ê¸° ê°ê°ì´ ì¢‹ë‹¤. ë¯¸í† ë§ˆê°€ ë¶€ìƒìœ¼ë¡œ ì œì™¸ëì§€ë§Œ ì¿ ë³´, ë„ì•ˆ, ë¯¸ë‚˜ë¯¸ë…¸ê°€ ê³µê²© ì¶•ì„ í˜•ì„±í•´ ê³µë°±ì„ ìµœì†Œí™”í•˜ëŠ” ì¤‘. í™ˆ ê²½ê¸°ì—ì„œ ì ìœ ìœ¨ ì¤‘ì‹¬ ë¹Œë“œì—…ì´ ë§¤ë„ëŸ½ê³ , ìˆ˜ë¹„ì§„ë„ ìš”ì‹œë‹¤ ì´íƒˆ ì´í›„ ë¼ì¸ ì •ë¹„ê°€ ì•ˆì •ì . ì „ë°˜ì ìœ¼ë¡œ ì¡°ì§ë ¥Â·ì²´ë ¥ ëª¨ë‘ ìš°ìœ„.

ê°€ë‚˜: ì´ë²ˆ ì†Œì§‘ì— ì „ë ¥ ëˆ„ìˆ˜ê°€ ë§¤ìš° í¼. íŒŒë¥´í‹°Â·ì¿ ë‘ìŠ¤Â·ì§€ì¿  ë“± í•µì‹¬ 6ëª…ì´ ì´íƒˆí•˜ë©° ì¤‘ì›Â·ìˆ˜ë¹„Â·2ì„  ëª¨ë‘ ì•½í™”. ìƒˆë¡œ í•©ë¥˜í•œ ìì›ë“¤ì€ Aë§¤ì¹˜ ê²½í—˜ì´ ë¶€ì¡±í•˜ê³  ì¼ë¶€ ì„ ìˆ˜ë“¤ì€ ì´ë™ ì¼ì •ìœ¼ë¡œ ì²´ë ¥ë„ ë¶ˆì•ˆì •. ì¤‘ì› ì¥ì•…ë ¥ ì €í•˜ë¡œ ì—­ìŠµ íŒ¨í„´ì´ ì‰½ê²Œ ì‚´ì•„ë‚˜ê¸° ì–´ë µê³ , í›„ë°˜ ì§‘ì¤‘ë ¥ ì €í•˜ ìœ„í—˜ë„ ë†’ìŒ.

âœ”ï¸ ìƒëŒ€ íë¦„ ë¶„ì„
ì¼ë³¸ì€ í™ˆì—ì„œ ì ìœ ìœ¨Â·ë¹Œë“œì—… ì¤‘ì‹¬ìœ¼ë¡œ ê²½ê¸° ì£¼ë„ ê°€ëŠ¥ì„±ì´ ë†’ê³ , ê°€ë‚˜ëŠ” ì£¼ì „ ê²°ì¥ìœ¼ë¡œ ì¡°ì§ë ¥ì´ í¬ê²Œ í”ë“¤ë¦° ìƒíƒœ. ì¼ë³¸ì˜ ë¼ì¸ ë°¸ëŸ°ìŠ¤ì™€ íŒ¨ìŠ¤ì›Œí¬ê°€ ìœ ì§€ë˜ë©´ ê°€ë‚˜ê°€ ì—­ìŠµìœ¼ë¡œ ë°˜ì „í•  ê°€ëŠ¥ì„±ì€ ë‚®ì•„ ë³´ì„.
ì˜ˆìƒ ìŠ¤ì½”ì–´: ì¼ë³¸ 2-1 ìŠ¹

âœ”ï¸ ë¶€ìƒì
(ì–‘ íŒ€ ëª¨ë‘ ì£¼ìš” ê²°ì¥ì ë¶„ì„ ë‚´ìš©ì— í¬í•¨)

ğŸ”¥ ì¶”ì²œí”½

âœ… ì¼ë°˜ìŠ¹: ì¼ë³¸ ìŠ¹
âœ… í•¸ë””ìº¡: ì¼ë³¸ í•¸ë”” ë¬´
âœ… ì–¸ì˜¤ë²„: ì˜¤ë²„
âœ… ì¶”ì„¸: ì¼ë³¸ ì¤‘ì›Â·ì¡°ì§ë ¥ ìš°ìœ„ + ê°€ë‚˜ í•µì‹¬ ì „ë ¥ ì´íƒˆ""",
        },
        {
            "id": "soccer_2",
            "title": "INTL - ëŒ€í•œë¯¼êµ­ vs ë³¼ë¦¬ë¹„ì•„",
            "summary": """ğŸ“Œ ëŒ€í•œë¯¼êµ­ vs ë³¼ë¦¬ë¹„ì•„ ë¶„ì„ ìš”ì•½

âœ”ï¸ íŒ€ ë¶„ìœ„ê¸° & ìµœê·¼ íë¦„
ëŒ€í•œë¯¼êµ­: í™ˆ ì´ì  + ì²´ë ¥ì  ì—¬ìœ  í™•ë³´. ë‹¤ë§Œ ì¤‘ì›ì—ì„œ í™©ì¸ë²”Â·ë°±ìŠ¹í˜¸Â·ì´ë™ê²½ ê²°ì¥ìœ¼ë¡œ íŒ¨ìŠ¤ í…œí¬ì™€ ë¹Œë“œì—… ë‹¤ì–‘ì„± ê°ì†Œ ìš°ë ¤. í•˜ì§€ë§Œ ì¡°ê·œì„±ì´ ì™„ì „ íšŒë³µ í›„ ë“ì  ê°ê° ìƒìŠ¹í•˜ë©° ìµœì „ë°© ê²½ìŸë ¥ ê°•í™”. ì¸¡ë©´ ì¤‘ì‹¬ ìš´ì˜ê³¼ 2ì„  ì¹¨íˆ¬ ì™„ì„±ë„ëŠ” ìœ ì§€ë˜ëŠ” íë¦„. ì „ë°© ì••ë°•ì˜ íš¨ìœ¨ë„ ìµœê·¼ í¬ê²Œ ì¢‹ì•„ì§„ ìƒíƒœ.
ë³¼ë¦¬ë¹„ì•„: ì „ì› ê°€ìš©ì´ì§€ë§Œ ì¥ê±°ë¦¬ ì´ë™ í”¼ë¡œê°€ ë³€ìˆ˜. ë‚¨ë¯¸ ë‚´ ê°•í•œ ì••ë°•ê³¼ íˆ¬ì§€ì— ë¹„í•´ í•´ì™¸ ì›ì •ì—ì„œëŠ” ê³µê²© ì „ê°œê°€ ë§¤ìš° ë‹µë‹µí•œ í¸. ë“ì  íš¨ìœ¨ ë–¨ì–´ì§€ê³ , ë¼ì¸ì„ ì§€ë‚˜ì¹˜ê²Œ ë‚´ë¦¬ëŠ” ê²½í–¥ì´ ìˆì–´ ì••ë°• ì—°ê³„ê°€ ëŠì–´ì§€ëŠ” ë¬¸ì œ ì§€ì†. ì¸¡ë©´ ì»¤ë²„ ì•½í•´ ì‹¤ì  ìœ„í—˜ ì¡´ì¬.

âœ”ï¸ ê²½ê¸° íë¦„ ì˜ˆìƒ
ëŒ€í•œë¯¼êµ­ì€ í™ˆì—ì„œ ì ìœ ìœ¨Â·ë¹Œë“œì—… ìš°ìœ„ë¡œ ì£¼ë„ê¶Œì„ ì¡ì„ ì „ë§. ì¤‘ì› ê²°ì¥ì´ ìˆì–´ë„ ì¸¡ë©´ í™œìš©ê³¼ ì„¸íŠ¸í”¼ìŠ¤ê°€ ì£¼ìš” ë“ì  ë£¨íŠ¸ê°€ ë  ê°€ëŠ¥ì„± í¼. ì¡°ê·œì„±ì˜ ì»¨ë””ì…˜ ìœ ì§€ë„ ê¸ì •ì . ë³¼ë¦¬ë¹„ì•„ëŠ” ë‚®ì€ ë¼ì¸ê³¼ ëŠë¦° ìˆ˜ë¹„ ì „í™˜ íƒ“ì— í•œêµ­ì˜ ì••ë°•Â·ì¹¨íˆ¬ë¥¼ ë²„í‹°ê¸° ì–´ë ¤ìš¸ íë¦„.
ì˜ˆìƒ ìŠ¤ì½”ì–´: ëŒ€í•œë¯¼êµ­ 2-0 ìŠ¹

âœ”ï¸ ë¶€ìƒì
(ì–‘ íŒ€ ëª¨ë‘ ì£¼ìš” ê²°ì¥ì ë¶„ì„ ë‚´ìš©ì— í¬í•¨)

ğŸ”¥ ì¶”ì²œí”½

âœ… ì¼ë°˜ìŠ¹: ëŒ€í•œë¯¼êµ­ ìŠ¹ 
âœ… í•¸ë””ìº¡: ëŒ€í•œë¯¼êµ­ ìŠ¹ 
âœ… ì–¸ì˜¤ë²„: ì–¸ë”""",
        },
    ],
    "ë†êµ¬": [
        {
            "id": "basket_1",
            "title": "NBA - í´ë¦¬ë¸”ëœë“œ vs í† ë¡ í† ",
            "summary": """ğŸ“Œ í´ë¦¬ë¸”ëœë“œ vs í† ë¡ í†  ë¶„ì„ ìš”ì•½

âœ”ï¸ íŒ€ ë¶„ìœ„ê¸° & ìµœê·¼ íë¦„
í´ë¦¬ë¸”ëœë“œ: ìµœê·¼ 6ê²½ê¸° 5ìŠ¹. ì£¼ì „ ê²°ì¥ì—ë„ ë§ˆì´ì• ë¯¸ ì›ì • ì„¤ìš• ì„±ê³µ. í™ˆ 3ì—°ìŠ¹ í¬í•¨ 4ìŠ¹ 1íŒ¨ë¡œ ì•ˆì •ê°.
í† ë¡ í† : ë¸Œë£¨í´ë¦°ì „ ìŠ¹ë¦¬ë¡œ ì—°íŒ¨ ì°¨ë‹¨. ë¦¬ë°”ìš´ë“œ ìš°ìœ„ëŠ” ì¢‹ì•˜ì§€ë§Œ ì›ì • 3ì—°ì „ ë§ˆì§€ë§‰ ê²½ê¸°ë¡œ ì²´ë ¥ ë¶€ë‹´ ê°€ëŠ¥.

âœ”ï¸ ìƒëŒ€ ì „ì 
ìµœê·¼ 5ê²½ê¸° í´ë¦¬ë¸”ëœë“œ 4ìŠ¹ 1íŒ¨ ìš°ì„¸.
ê°€ì¥ ìµœê·¼ í™ˆ ë§ëŒ€ê²°ì—ì„œëŠ” í´ë¦¬ë¸”ëœë“œ íŒ¨ë°°.

âœ”ï¸ ë¶€ìƒì
í´ë¦¬ë¸”ëœë“œ ìºë²Œë¦¬ì–´ìŠ¤:
- ëŒ€ë¦¬ì–´ìŠ¤ ê°ˆëœë“œ(G) 11ì›” 13ì¼ ë³µê·€ ì˜ˆì •
- ì œì¼ëŸ° íƒ€ì´ìŠ¨(G) 11ì›” 13ì¼ ë³µê·€ ì˜ˆì •
- ì—ë°˜ ëª¨ë¸”ë¦¬(C) 11ì›” 13ì¼ ë³µê·€ ì˜ˆì •
- ë„ë…¸ë°˜ ë¯¸ì²¼(G) 11ì›” 13ì¼ ë³µê·€ ì˜ˆì •
- ë§¥ìŠ¤ ìŠ¤íŠ¸ëŸ¬ìŠ¤(G) 12ì›” 1ì¼ ë³µê·€ ì˜ˆì •

í† ë¡ í†  ë©í„°ìŠ¤:
- ìƒŒë“œë¡œ ë§ˆë¬´ì¼ˆë¼ìŠˆë¹Œë¦¬(F) ë‹¹ì¼ ê²°ì •
- ì˜¤ì°¨ì´ ì•„ë°”ì§€(G) ë‹¹ì¼ ê²°ì •
- ì½œë¦° ë¨¸ë ˆì´ ë³´ì¼ìŠ¤(F) ë‹¹ì¼ ê²°ì •

ğŸ”¥ ì¶”ì²œí”½
âœ… ì¼ë°˜ìŠ¹: í´ë¦¬ë¸”ëœë“œ ìŠ¹
âœ… í•¸ë””ìº¡: í´ë¦¬ë¸”ëœë“œ -7.5 ìŠ¹
âœ… ì–¸ì˜¤ë²„: 240.5 ì˜¤ë²„
âœ… ì¶”ì„¸: í™ˆ ê°•ì„¸ + ì£¼ì „ ë³µê·€ë¡œ í´ë¦¬ë¸”ëœë“œ ê¸°ëŒ€ì¹˜ ìƒìŠ¹""",
        },
        {
            "id": "basket_2",
            "title": "NBA - í”¼ë‹‰ìŠ¤ vs ì¸ë””ì• ë‚˜",
            "summary": """ğŸ“Œ í”¼ë‹‰ìŠ¤ vs ì¸ë””ì• ë‚˜ ë¶„ì„ ìš”ì•½

âœ”ï¸ íŒ€ ë¶„ìœ„ê¸° & ìµœê·¼ íë¦„
í”¼ë‹‰ìŠ¤: 4ì—°ìŠ¹ + ìµœê·¼ 7ê²½ê¸° 6ìŠ¹ 1íŒ¨ íë¦„. ë¶€ì»¤Â·êµ¿ìœˆÂ·ê·¸ë ˆì´ìŠ¨ ì•¨ëŸ°ì´ ê¾¸ì¤€íˆ ë“ì í•˜ë©° ê²½ê¸° ì£¼ë„.
ì¸ë””ì• ë‚˜: 5ì—°íŒ¨ + ì›ì • 6ì—°íŒ¨. ì‹œì•„ìº„ì´ ë¶„ì „í–ˆì§€ë§Œ í•µì‹¬ ì „ë ¥ ë¶€ì¬ë¡œ ê³µê²©Â·ìˆ˜ë¹„ ëª¨ë‘ ë¶•ê´´.

âœ”ï¸ ìƒëŒ€ ì „ì 
ìµœê·¼ ë§ëŒ€ê²°ì—ì„œ í”¼ë‹‰ìŠ¤ê°€ 108-126 íŒ¨ë°°.
ìµœê·¼ 5ê²½ê¸° 2ìŠ¹ 3íŒ¨.

âœ”ï¸ ë¶€ìƒì
í”¼ë‹‰ìŠ¤ ì„ ì¦ˆ:
- ì œì¼ëŸ° ê·¸ë¦°(G) 12ì›” 18ì¼ ë³µê·€ ì˜ˆì •

ì¸ë””ì• ë‚˜ í˜ì´ì„œìŠ¤:
- ìº  ì¡´ìŠ¤(G) 12ì›” 3ì¼ ë³µê·€ ì˜ˆì •
- ë² ë„¤ë”•íŠ¸ ë§ˆì„œë¦°(G) 11ì›” 15ì¼ ë³µê·€ ì˜ˆì •
- ì¡°ë‹ˆ í¼í”¼(G) 11ì›” 15ì¼ ë³µê·€ ì˜ˆì •
- í€¸íŠ¼ ì­ìŠ¨(G) 11ì›” 15ì¼ ë³µê·€ ì˜ˆì •
- ì˜¤ë¹„ í† í•€(F) 2ì›” 2ì¼ ë³µê·€ ì˜ˆì •

ğŸ”¥ ì¶”ì²œí”½
âœ… ì¼ë°˜ìŠ¹: í”¼ë‹‰ìŠ¤ ìŠ¹
âœ… í•¸ë””ìº¡: í”¼ë‹‰ìŠ¤ -4.5 ìŠ¹
âœ… ì–¸ì˜¤ë²„: 230.5 ì˜¤ë²„
âœ… ì¶”ì„¸: í™ˆ ê°•ì„¸ + ì¸ë””ì• ë‚˜ ì „ë ¥ ë¶•ê´´""",
        },
                {
            "id": "basket_3",
            "title": "NBA - ìœ íƒ€ vs ì• í‹€ëœíƒ€",
            "summary": """ğŸ“Œ ìœ íƒ€ vs ì• í‹€ëœíƒ€ ë¶„ì„ ìš”ì•½

âœ”ï¸ íŒ€ ë¶„ìœ„ê¸° & ìµœê·¼ íë¦„
ìœ íƒ€: ì¸ë””ì• ë‚˜ì „ 152ë“ì  í­ë°œë¡œ 3ì—°íŒ¨ íƒˆì¶œ. ë§ˆì¹´ë„¨ 35ë“ì , ë£¨í‚¤ ë² ì¼ë¦¬Â·ë¯¸í•˜ì¼ë¥˜í¬ í™œì•½ìœ¼ë¡œ ê³µê²©ë ¥ ìƒìŠ¹. ì½œë¦¬ì–´ì˜ 11ì–´ì‹œìŠ¤íŠ¸ë¡œ ë³¼ ì „ê°œ ì•ˆì •. í™ˆ 3ìŠ¹2íŒ¨ë¡œ íë¦„ ê´œì°®ìŒ.
ì• í‹€ëœíƒ€: íŠ¸ë ˆì´ ì˜ ì—†ì´ë„ 3ì—°ìŠ¹. ìƒˆí¬ë¼ë©˜í† ì „ 133-100 ì™„ìŠ¹ í¬í•¨ ì›ì • 2ì—°ìŠ¹. ì œì¼ëŸ° ì¡´ìŠ¨ ì¤‘ì‹¬ìœ¼ë¡œ 7ëª…ì´ ë‘ ìë¦¿ìˆ˜ ë“ì í•˜ë©° ê³ ë¥¸ ì „ë ¥. ë‹¤ë§Œ ë°±íˆ¬ë°± ì›ì •ìœ¼ë¡œ ì²´ë ¥ ë¶€ë‹´ ì¡´ì¬.

âœ”ï¸ ìƒëŒ€ ì „ì 
ìµœê·¼ ë§ëŒ€ê²°ì—ì„œ ìœ íƒ€ê°€ 134-147 íŒ¨ë°°
ìµœê·¼ 5ê²½ê¸° 1ìŠ¹ 4íŒ¨ë¡œ ìœ íƒ€ ì—´ì„¸

âœ”ï¸ ë¶€ìƒì
ìœ íƒ€ ì¬ì¦ˆ:
í…Œì¼ëŸ¬ í—¨ë“œë¦­ìŠ¤(F) 11ì›”16ì¼ ë³µê·€ ì˜ˆì •
ì¹´ì¼ ì•¤ë”ìŠ¨(F) 11ì›”16ì¼ ë³µê·€ ì˜ˆì •
ì¡°ì§€ìŠ¤ ë‹ˆì•™(F) 11ì›”18ì¼ ë³µê·€ ì˜ˆì •
ì›Œì»¤ ì¼€ìŠ¬ëŸ¬(C) ì‹œì¦Œ ì•„ì›ƒ

ì• í‹€ëœíƒ€ í˜¸í¬ìŠ¤:
ë‹ˆì½œë¼ ë‘ë¦¬ì‹œì¹˜(F) 11ì›”13ì¼ ë³µê·€ ì˜ˆì •
íŠ¸ë ˆì´ ì˜(G) 11ì›”30ì¼ ë³µê·€ ì˜ˆì •

ğŸ”¥ ì¶”ì²œí”½

âœ… ì¼ë°˜ìŠ¹: ìœ íƒ€ ìŠ¹
âœ… í•¸ë””ìº¡: ìœ íƒ€ +1.5 ìŠ¹
âœ… ì–¸ì˜¤ë²„: 233.5 ì–¸ë”
âœ… ì¶”ì„¸: í™ˆ ê³µê²©ë ¥ ìƒìŠ¹ + ì• í‹€ëœíƒ€ ë°±íˆ¬ë°± ì²´ë ¥ ë¶€ë‹´""",
        },
    ],

    "ì•¼êµ¬": [
        {
            "id": "base_1",
            "title": "ì‹œì¦Œ OFF",
            "summary": "ì‹œì¦Œ ì‹œì‘ í›„ ë¶„ì„ê¸€ ê²Œì¬ë©ë‹ˆë‹¤."
        },
    ],
    "ë°°êµ¬": [
                {
            "id": "vball_1",
            "title": "Vë¦¬ê·¸ - ìš°ë¦¬ì¹´ë“œ vs í•œêµ­ì „ë ¥",
            "summary": """ğŸ“Œ ìš°ë¦¬ì¹´ë“œ vs í•œêµ­ì „ë ¥ ë¶„ì„ ìš”ì•½

âœ”ï¸ íŒ€ ë¶„ìœ„ê¸° & ìµœê·¼ íë¦„
ìš°ë¦¬ì¹´ë“œ: 4ì—°íŒ¨ ì¤‘. ì•„ë¼ìš°ì¡°ê°€ 15ë“ì ìœ¼ë¡œ ë¶„ì „í–ˆì§€ë§Œ ê³µê²© ì§€ì› ë¶€ì¡±, ì„¸í„°ì™€ì˜ í˜¸í¡ ë¬¸ì œ, ì„œë¸ŒÂ·ë¦¬ì‹œë¸Œ ë¶ˆì•ˆê¹Œì§€ ê²¹ì¹˜ë©° ì „ì²´ì ì¸ ê²½ê¸°ë ¥ í•˜ë½. ê³µê²© íŒ¨í„´ì´ ë‹¨ì¡°ë¡œì›Œ ìƒëŒ€ ë¸”ë¡œí‚¹ì— ì‰½ê²Œ ë§‰íˆëŠ” íë¦„. í™ˆì—ì„œëŠ” 1ìŠ¹1íŒ¨.
í•œêµ­ì „ë ¥: ìµœê·¼ KBì†ë³´ì „ íŒ¨ë°°ë¡œ 2ì—°ìŠ¹ ì¢…ë£Œ. ì—ë°˜ìŠ¤Â·ê¹€ì •í˜¸ ë“ì ì€ ê¾¸ì¤€í•˜ë‚˜ ê²°ì •ì  ìˆœê°„ ë²”ì‹¤ì´ ë¬¸ì œ. ì„œë¸Œ ì •í™•ë„ ì €í•˜ë¡œ ì—­ì „ ê¸°íšŒ ë†“ì¹œ ì ì´ ì•„ì‰¬ì›€. ì›ì • 2ì—°íŒ¨ íë¦„.

âœ”ï¸ ìƒëŒ€ ì „ì 
1ì°¨ì „ ë§ëŒ€ê²°: ìš°ë¦¬ì¹´ë“œ 3-0 ìŠ¹ë¦¬
ìµœê·¼ 5ê²½ê¸°: 3ìŠ¹ 2íŒ¨

âœ”ï¸ ë¶€ìƒì
ë¶€ìƒì ì •ë³´ ì—†ìŒ

ğŸ”¥ ì¶”ì²œí”½

âœ… ì¼ë°˜ìŠ¹: í•œêµ­ì „ë ¥ ìŠ¹
âœ… í•¸ë””ìº¡: í•œêµ­ì „ë ¥ ìŠ¹
âœ… ì–¸ì˜¤ë²„: ì˜¤ë²„
âœ… ì¶”ì„¸: ìš°ë¦¬ì¹´ë“œ 4ì—°íŒ¨ íë¦„ + í•œêµ­ì „ë ¥ ê³µê²© ë¼ì¸ ìš°ì„¸""",
        },
                        {
            "id": "vball_2",
            "title": "Vë¦¬ê·¸ - IBKê¸°ì—…ì€í–‰ vs GSì¹¼í…ìŠ¤",
            "summary": """ğŸ“Œ IBKê¸°ì—…ì€í–‰ vs GSì¹¼í…ìŠ¤ ë¶„ì„ ìš”ì•½

âœ”ï¸ íŒ€ ë¶„ìœ„ê¸° & ìµœê·¼ íë¦„
IBKê¸°ì—…ì€í–‰: 4ì—°íŒ¨ íë¦„. ë¹…í† ë¦¬ì•„ê°€ 38ë“ì ìœ¼ë¡œ ë¶„ì „í–ˆê³  ìµœì •ë¯¼ë„ ë¸”ë¡œí‚¹ 6ê°œ í¬í•¨ 16ë“ì ìœ¼ë¡œ í™œì•½í–ˆì§€ë§Œ, ì£¼ì „ ì„¸í„° ê¹€í•˜ê²½ì´ ë°œëª© ì¸ëŒ€ íŒŒì—´ë¡œ ë“¤ê²ƒ ì´ì†¡. ì´ì†Œì˜ ì‹œì¦Œ ì•„ì›ƒê¹Œì§€ ê²¹ì¹˜ë©° ì„¸í„°Â·ê³µê²© ë¼ì¸ ë™ì‹œ ë¶•ê´´. ë°•ì€ì„œÂ·ìµœì—°ì§„ ì„¸í„° ì²´ì œë¡œ ìš´ì˜í•´ì•¼ í•˜ëŠ” ì–´ë ¤ìš´ ìƒí™©. í™ˆì—ì„œë„ 1ìŠ¹2íŒ¨ë¡œ íë¦„ ì¢‹ì§€ ì•ŠìŒ.
GSì¹¼í…ìŠ¤: 5ê²½ê¸° ì—°ì† í’€ì„¸íŠ¸ ìŠ¹ë¶€ ì¤‘ì´ë©° ì§ì „ê²½ê¸° í˜„ëŒ€ê±´ì„¤ì „ 3-2 ìŠ¹ë¦¬ë¡œ ë°˜ë“±. ì‹¤ë°”ê°€ í†µì¦ì—ë„ ëê¹Œì§€ ë›°ë©° ê²°ì •ì  ìˆœê°„ í™œì•½. ë¸”ë¡œí‚¹Â·ì„œë¸Œ ìš°ìœ„, í›„ë°˜ ì§‘ì¤‘ë ¥ ì–‘í˜¸. ê·¸ëŸ¬ë‚˜ ë ˆì´ë‚˜ ê²°ì¥ìœ¼ë¡œ ì‹¤ë°” ì˜ì¡´ë„ê°€ ë†’ì€ ì ì€ ë³€ìˆ˜.

âœ”ï¸ ìƒëŒ€ ì „ì 
ìµœê·¼ ë§ëŒ€ê²°: IBKê¸°ì—…ì€í–‰ 1-3 íŒ¨ë°°
ìµœê·¼ 5ê²½ê¸°: 1ìŠ¹ 4íŒ¨ë¡œ IBK ì—´ì„¸

âœ”ï¸ ë¶€ìƒì
IBKê¸°ì—…ì€í–‰:ê¹€í•˜ê²½ ì¸ëŒ€ íŒŒì—´, ì´ì†Œì˜ ì‹œì¦Œ ì•„ì›ƒ

ğŸ”¥ ì¶”ì²œí”½

âœ… ì¼ë°˜ìŠ¹: GSì¹¼í…ìŠ¤ ìŠ¹
âœ… í•¸ë””ìº¡: GSì¹¼í…ìŠ¤ ìŠ¹
âœ… ì–¸ì˜¤ë²„: ì–¸ë”
âœ… ì¶”ì„¸: IBK ì„¸í„°Â·ê³µê²© ë¼ì¸ ê³µë°± + GSì¹¼í…ìŠ¤ ë¸”ë¡œí‚¹Â·ì„œë¸Œ ìš°ìœ„""",
        },
    ],
}

NEWS_ITEMS = [
    {
        "id": "news_1",
        "title": "ğŸ“Œ ë‹¤ì €ìŠ¤ ê¹œì§ í™œì•½ ë°±ì—… í¬ìˆ˜ ë²¤ ë¡œíŠ¸ë²„íŠ¸, ì‹ ì‹œë‚´í‹°ë¡œ ì´ì ",
        "summary": """LA ë‹¤ì €ìŠ¤ì˜ â€˜ìˆ¨ì€ ì¡°ë ¥ìâ€™ ë²¤ ë¡œíŠ¸ë²„íŠ¸ê°€ íŒ€ì„ ë– ë‚˜ ì‹ ì‹œë‚´í‹° ë ˆì¦ˆë¡œ ì´ì í–ˆë‹¤. ë‹¤ì €ìŠ¤ê°€ ê·¸ë¥¼ ì›¨ì´ë²„ì— ì˜¬ë ¸ê³ , ì‹ ì‹œë‚´í‹°ê°€ í´ë ˆì„í•˜ë©° ì˜ì…ì„ í™•ì •í–ˆë‹¤.

ë¡œíŠ¸ë²„íŠ¸ëŠ” ì˜¬ ì‹œì¦Œ ë¶€ìƒ ê³µë°± ì†ì—ì„œ ê¸°íšŒë¥¼ ì¡ì•„ 18ê²½ê¸°ì—ì„œ íƒ€ìœ¨ 0.224, 1í™ˆëŸ°, 4íƒ€ì ì„ ê¸°ë¡í•˜ë©° ë‚´ì…”ë„ë¦¬ê·¸ ì„œë¶€ì§€êµ¬ ìš°ìŠ¹ì— í˜ì„ ë³´íƒ°ë‹¤. íŠ¹íˆ ë›°ì–´ë‚œ ìˆ˜ë¹„ë ¥ê³¼ í”„ë ˆì´ë°ìœ¼ë¡œ ì•¼ë§ˆëª¨í† , ìŠ¤ë„¬, ê¸€ë˜ìŠ¤ë‚˜ìš° ë“± ì„ ë°œì§„ì„ ì•ˆì •ì‹œí‚¤ë©° â€œ2025 íŠ¸ë ˆì´ë“œ ìµœê³ ì˜ ê¹œì§ ì˜ì…â€ìœ¼ë¡œ í‰ê°€ë°›ì•˜ë‹¤.

í¬ìŠ¤íŠ¸ì‹œì¦Œì—ì„œë„ ì™€ì¼ë“œì¹´ë“œ ì‹œë¦¬ì¦ˆì—ì„œ í™œì•½í–ˆì§€ë§Œ, ìœŒ ìŠ¤ë¯¸ìŠ¤ê°€ ë³µê·€í•˜ë©´ì„œ ì›”ë“œì‹œë¦¬ì¦ˆì—ì„œëŠ” ê¸°íšŒë¥¼ ì¡ì§€ ëª»í–ˆë‹¤. ì²« WS ìš°ìŠ¹ ë°˜ì§€ë¥¼ ë‚€ ë¡œíŠ¸ë²„íŠ¸ëŠ” ì´ì œ ì‹ ì‹œë‚´í‹°ì—ì„œ ìƒˆë¡œìš´ ë„ì „ì— ë‚˜ì„ ë‹¤."""
    },
    {
        "id": "news_2",
        "title": "ğŸ“Œ ì²¼ì‹œ, ë‹ˆì½” íŒŒìŠ¤ ì˜ì… ë¬¸ì˜â€¦ë ˆì•Œ ë³µê·€ëŠ” ì•„ì§ ë¯¸ì •",
        "summary":"""ì²¼ì‹œê°€ ì½”ëª¨ì—ì„œ ë›°ê³  ìˆëŠ” ë¯¸ë“œí•„ë” ë‹ˆì½” íŒŒìŠ¤ ì˜ì… ê°€ëŠ¥ì„±ì„ íƒ€ì§„í•˜ë©° í˜‘ìƒì— ë“¤ì–´ê°”ë‹¤.
íŒŒìŠ¤ëŠ” ì›ë˜ ë ˆì•Œ ë§ˆë“œë¦¬ë“œê°€ ê¸°ëŒ€í•˜ë˜ ìœ ë§ì£¼ë¡œ, 2022-23ì‹œì¦Œ 1êµ° ë¬´ëŒ€ì— ë°ë·”í•˜ë©° ì£¼ëª©ë°›ì•˜ë‹¤. ì§€ë‚œ ì‹œì¦Œì—” ì±”í”¼ì–¸ìŠ¤ë¦¬ê·¸ì—ì„œë„ ì¶œì „í•˜ë©° 8ê²½ê¸° 1ê³¨ì„ ê¸°ë¡í–ˆë‹¤.

í•˜ì§€ë§Œ ë” ë§ì€ ì¶œì „ ì‹œê°„ì„ ì›í•´ ì½”ëª¨ë¡œ ì´ì í–ˆê³ , íŒŒë¸Œë ˆê°€ìŠ¤ ê°ë… ì•„ë˜ ì§€ë‚œ ì‹œì¦Œ 35ê²½ê¸° 6ê³¨ 9ë„ì›€ìœ¼ë¡œ í•µì‹¬ ìì›ìœ¼ë¡œ ì„±ì¥í–ˆë‹¤. ì˜¬ ì‹œì¦Œì—ë„ ì¢‹ì€ í™œì•½ì„ ì´ì–´ê°€ë©° ë ˆì•Œ ë³µê·€ì„¤ì´ ê¾¸ì¤€íˆ ë‚˜ì˜¤ê³  ìˆë‹¤.

ì²¼ì‹œê°€ ê´€ì‹¬ì„ ë“œëŸ¬ëƒˆì§€ë§Œ ìµœì¢… ê²°ì •ê¶Œì€ ë ˆì•Œì— ìˆë‹¤. ë ˆì•Œì€ ë‚´ë…„ ì—¬ë¦„ 900ë§Œ ìœ ë¡œ ë°”ì´ë°± ì˜µì…˜ì„ í†µí•´ íŒŒìŠ¤ë¥¼ ë‹¤ì‹œ ë°ë ¤ì˜¬ ìˆ˜ ìˆëŠ” ìƒí™©ì´ë‹¤."""
    },
        {
        "id": "news_3",
        "title": "ğŸ“Œ í•œêµ­ë„ë¡œê³µì‚¬, ë˜ ì˜í”Œë ˆì´ì–´ìƒ ë‚˜ì˜¤ë‚˜? ì‹ ì¸ 1ìˆœìœ„ ì´ì§€ìœ¤ ë§¹í™œì•½",
        "summary":"""í•œêµ­ë„ë¡œê³µì‚¬ì˜ ì‹ ì¸ ë¯¸ë“¤ë¸”ë¡œì»¤ **ì´ì§€ìœ¤(18)**ì´ í”„ë¡œ ì²« ì‹œì¦Œë¶€í„° ì£¼ì „ìœ¼ë¡œ ìë¦¬ ì¡ìœ¼ë©° ì˜í”Œë ˆì´ì–´ìƒ ìœ ë ¥ í›„ë³´ë¡œ ë– ì˜¬ëë‹¤. ë§Œì•½ ìˆ˜ìƒí•œë‹¤ë©´ ë„ë¡œê³µì‚¬ëŠ” 3ì‹œì¦Œ ì—°ì† ì˜í”Œë ˆì´ì–´ìƒ ë°°ì¶œì„ ë‹¬ì„±í•˜ê²Œ ëœë‹¤.

ì „ì²´ 1ìˆœìœ„ì˜€ë˜ ì´ì§€ìœ¤ì€ ì˜¬ ì‹œì¦Œ 6ê²½ê¸° 25ì„¸íŠ¸ì—ì„œ

ê³µê²© ì„±ê³µë¥  46%

ì„¸íŠ¸ë‹¹ ë¸”ë¡œí‚¹ 0.400ê°œ

ì„¸íŠ¸ë‹¹ ì„œë¸Œ 0.200ê°œ

ë“± ì¤€ìˆ˜í•œ ê¸°ë¡ì„ ë‚¨ê¸°ë©° íŒ€ì˜ 6ìŠ¹ 1íŒ¨ ì„ ë‘ ì§ˆì£¼ì— í¬ê²Œ ê¸°ì—¬í–ˆë‹¤.

ì£¼ì „ ê¸°íšŒëŠ” ë°°ìœ ë‚˜ì˜ ë¶€ìƒìœ¼ë¡œ ì°¾ì•„ì™”ê³ , ë°ë·”ì „ë¶€í„° 10ì Â·ê³µê²© ì„±ê³µë¥  66.67%Â·ì„œë¸Œ ì—ì´ìŠ¤ 3ê°œë¥¼ ê¸°ë¡í•˜ë©° ì™„ë²½í•˜ê²Œ ì‘ë‹µí–ˆë‹¤. ì´í›„ ëª¨ë“  ì„¸íŠ¸ì— ì¶œì „í•˜ë©° íŒ€ ê³µê²©ê³¼ ìˆ˜ë¹„ ë¼ì¸ì„ ì•ˆì •ì‹œì¼°ë‹¤.

ë„ë¡œê³µì‚¬ëŠ” ê³¼ê±° ì˜í”Œë ˆì´ì–´ìƒ ìˆ˜ìƒì ê¹€ì„¸ë¹ˆ, ê¹€ë‹¤ì€ì— ì´ì–´ ì´ì§€ìœ¤ê¹Œì§€ ìˆ˜ìƒí•œë‹¤ë©´ â€˜ì‹ ì¸ì„¼í„° ëª…ê°€â€™ ì´ë¯¸ì§€ë¥¼ ê°•í™”í•˜ê²Œ ëœë‹¤.

ë‹¤ë§Œ ê²½ìŸìë„ ë§Œë§Œì¹˜ ì•Šë‹¤.

ìµœì„œí˜„(ì •ê´€ì¥)

ìµœìœ ë¦¼(GSì¹¼í…ìŠ¤)

íŠ¹íˆ 2ë…„ì°¨ ë¯¸ë“¤ë¸”ë¡œì»¤ **ìµœìœ ë¦¼ì€ ê³µê²© ì„±ê³µë¥  50%**ë¡œ ì´ì§€ìœ¤ë³´ë‹¤ íš¨ìœ¨ì´ ë†’ì•„ ì¹˜ì—´í•œ ê²½ìŸì´ ì˜ˆìƒëœë‹¤. ì´ì§€ìœ¤ì€ ê³µê²©ë ¥ì„ ë” ëŒì–´ì˜¬ë ¤ì•¼ ìš°ìœ„ë¥¼ í™•ì‹¤íˆ ì¡ì„ ìˆ˜ ìˆë‹¤."""
    },
]

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ í‚¤ë³´ë“œ/ë©”ë‰´ êµ¬ì„± â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

def build_reply_keyboard() -> ReplyKeyboardMarkup:
    """ë´‡ 1:1 í…ŒìŠ¤íŠ¸ìš© ê°„ë‹¨ í•˜ë‹¨ í‚¤ë³´ë“œ"""
    menu = [
        ["ë©”ë‰´ ë¯¸ë¦¬ë³´ê¸°", "ë„ì›€ë§"],
    ]
    return ReplyKeyboardMarkup(menu, resize_keyboard=True)


def build_main_inline_menu() -> InlineKeyboardMarkup:
    """ë©”ì¸ ì¸ë¼ì¸ ë©”ë‰´ (ì±„ë„/ë¯¸ë¦¬ë³´ê¸° ê³µí†µ)"""
    buttons = [
        [InlineKeyboardButton("ì‹¤ì‹œê°„ ë¬´ë£Œ ì¤‘ê³„", url="https://goat-tv.com")],
        [InlineKeyboardButton("11.14 ê²½ê¸° ë¶„ì„í”½", callback_data="analysis_root")],
        [InlineKeyboardButton("ìŠ¤í¬ì¸  ë‰´ìŠ¤ ìš”ì•½", callback_data="news_root")],
    ]
    return InlineKeyboardMarkup(buttons)


def build_analysis_category_menu() -> InlineKeyboardMarkup:
    """11.14 ê²½ê¸° ë¶„ì„í”½ â†’ ì¢…ëª© ì„ íƒ ë©”ë‰´"""
    buttons = [
        [InlineKeyboardButton("ì¶•êµ¬", callback_data="analysis_cat:ì¶•êµ¬")],
        [InlineKeyboardButton("ë†êµ¬", callback_data="analysis_cat:ë†êµ¬")],
        [InlineKeyboardButton("ì•¼êµ¬", callback_data="analysis_cat:ì•¼êµ¬")],
        [InlineKeyboardButton("ë°°êµ¬", callback_data="analysis_cat:ë°°êµ¬")],
        [InlineKeyboardButton("â—€ ë©”ì¸ ë©”ë‰´ë¡œ", callback_data="back_main")],
    ]
    return InlineKeyboardMarkup(buttons)


def build_analysis_match_menu(sport: str) -> InlineKeyboardMarkup:
    """ì¢…ëª© ì„ íƒ í›„ â†’ í•´ë‹¹ ì¢…ëª© ê²½ê¸° ë¦¬ìŠ¤íŠ¸ ë©”ë‰´"""
    items = ANALYSIS_DATA.get(sport, [])
    buttons = []
    for item in items:
        cb = f"match:{sport}:{item['id']}"
        buttons.append([InlineKeyboardButton(item["title"], callback_data=cb)])
    buttons.append([InlineKeyboardButton("â—€ ì¢…ëª© ì„ íƒìœ¼ë¡œ", callback_data="analysis_root")])
    buttons.append([InlineKeyboardButton("â—€ ë©”ì¸ ë©”ë‰´ë¡œ", callback_data="back_main")])
    return InlineKeyboardMarkup(buttons)


def build_news_list_menu() -> InlineKeyboardMarkup:
    """ìŠ¤í¬ì¸  ë‰´ìŠ¤ ìš”ì•½ â†’ ë‰´ìŠ¤ ì œëª© ë¦¬ìŠ¤íŠ¸ ë©”ë‰´"""
    buttons = []
    for idx, item in enumerate(NEWS_ITEMS):
        cb = f"news_item:{idx}"
        buttons.append([InlineKeyboardButton(item["title"], callback_data=cb)])
    buttons.append([InlineKeyboardButton("â—€ ë©”ì¸ ë©”ë‰´ë¡œ", callback_data="back_main")])
    return InlineKeyboardMarkup(buttons)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ê³µí†µ: ë©”ì¸ ë©”ë‰´ ë³´ë‚´ëŠ” í•¨ìˆ˜ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

async def send_main_menu(chat_id: int | str, context: ContextTypes.DEFAULT_TYPE, preview: bool = False):
    """
    ì±„ë„/DM ê³µí†µìœ¼ë¡œ 'í…ìŠ¤íŠ¸ + ë©”ì¸ ë©”ë‰´ ë²„íŠ¼' ì „ì†¡.
    (ì´ë¯¸ì§€ëŠ” ì‚¬ìš©í•˜ì§€ ì•ŠìŒ)
    """
    msg = await context.bot.send_message(
        chat_id=chat_id,
        text=MENU_CAPTION,
        reply_markup=build_main_inline_menu(),
    )
    return msg

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ í•¸ë“¤ëŸ¬ë“¤ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# 1) /start â€“ DMì—ì„œ ì±„ë„ê³¼ ë™ì¼í•œ ë ˆì´ì•„ì›ƒ ë¯¸ë¦¬ë³´ê¸°
async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    chat_id = update.effective_chat.id

    # ì•ˆë‚´ + í•˜ë‹¨ í…ŒìŠ¤íŠ¸ í‚¤ë³´ë“œ
    await update.message.reply_text(
        "ìŠ¤í¬ì¸ ë´‡ì…ë‹ˆë‹¤.\n"
        "ì•„ë˜ì—ëŠ” ì±„ë„ì— ì˜¬ë¼ê°ˆ ë©”ë‰´ì™€ ë™ì¼í•œ ë ˆì´ì•„ì›ƒ ë¯¸ë¦¬ë³´ê¸°ë¥¼ ë³´ì—¬ì¤„ê²Œ.\n"
        "ì‹¤ì œ ì±„ë„ ë°°í¬ëŠ” /publish ëª…ë ¹ìœ¼ë¡œ ì§„í–‰í•˜ë©´ ë¼.",
        reply_markup=build_reply_keyboard(),
    )

    # ì±„ë„ê³¼ ë˜‘ê°™ì€ í…ìŠ¤íŠ¸ + ë©”ì¸ ë©”ë‰´ ë¯¸ë¦¬ë³´ê¸°
    await send_main_menu(chat_id, context, preview=True)


# 2) DM í…ìŠ¤íŠ¸ ì²˜ë¦¬ â€“ ê°„ë‹¨ í…ŒìŠ¤íŠ¸ìš©
async def on_text(update: Update, context: ContextTypes.DEFAULT_TYPE):
    text = (update.message.text or "").strip()
    if "ë©”ë‰´ ë¯¸ë¦¬ë³´ê¸°" in text:
        await start(update, context)
    elif "ë„ì›€ë§" in text:
        await update.message.reply_text(
            "/start : ë©”ë‰´ ë¯¸ë¦¬ë³´ê¸°\n"
            "/publish : ì±„ë„ì— ë©”ë‰´ ì „ì†¡ + ìƒë‹¨ ê³ ì •"
        )
    else:
        await update.message.reply_text("ë©”ë‰´ ë¯¸ë¦¬ë³´ê¸°ëŠ” /start ë˜ëŠ” 'ë©”ë‰´ ë¯¸ë¦¬ë³´ê¸°' ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.")


# 3) /publish â€“ ì±„ë„ë¡œ ë©”ë‰´ ë³´ë‚´ê³  ìƒë‹¨ ê³ ì •
async def publish(update: Update, context: ContextTypes.DEFAULT_TYPE):
    if not CHANNEL_ID:
        await update.message.reply_text("CHANNEL_IDê°€ ë¹„ì–´ ìˆìŠµë‹ˆë‹¤. Render í™˜ê²½ë³€ìˆ˜ì— CHANNEL_IDë¥¼ ì„¤ì •í•˜ì„¸ìš”.")
        return

    # ê¸°ì¡´ ê³ ì • ë©”ì‹œì§€ í•´ì œ (ì„ íƒ)
    try:
        await context.bot.unpin_all_chat_messages(CHANNEL_ID)
    except Exception:
        pass

    # ì±„ë„ì— DMê³¼ ë™ì¼í•œ ë©”ë‰´ ì „ì†¡
    msg = await send_main_menu(CHANNEL_ID, context, preview=False)

    # ë°©ê¸ˆ ë³´ë‚¸ ë©”ë‰´ ë©”ì‹œì§€ ìƒë‹¨ ê³ ì •
    await context.bot.pin_chat_message(
        chat_id=CHANNEL_ID,
        message_id=msg.message_id,
        disable_notification=True,
    )

    await update.message.reply_text("ì±„ë„ì— ë©”ë‰´ë¥¼ ì˜¬ë¦¬ê³  ìƒë‹¨ì— ê³ ì •í–ˆìŠµë‹ˆë‹¤ âœ…")


# 4) ì¸ë¼ì¸ ë²„íŠ¼ ì½œë°± ì²˜ë¦¬ (ë¶„ì„/ë‰´ìŠ¤ íŒì—…)
async def on_callback(update: Update, context: ContextTypes.DEFAULT_TYPE):
    q = update.callback_query
    data = q.data or ""
    await q.answer()  # ê¸°ë³¸ ë¡œë”©í‘œì‹œ ì œê±°

    # ë©”ì¸ ë©”ë‰´ë¡œ ëŒì•„ê°€ê¸°
    if data == "back_main":
        await q.edit_message_reply_markup(reply_markup=build_main_inline_menu())
        return

    # ë¶„ì„í”½ ë£¨íŠ¸: ì¢…ëª© ë¦¬ìŠ¤íŠ¸
    if data == "analysis_root":
        await q.edit_message_reply_markup(reply_markup=build_analysis_category_menu())
        return

    # ë¶„ì„í”½ â€“ ì¢…ëª© ì„ íƒ
    if data.startswith("analysis_cat:"):
        sport = data.split(":", 1)[1]
        await q.edit_message_reply_markup(reply_markup=build_analysis_match_menu(sport))
        return

    # âœ… ë¶„ì„í”½ â€“ ê°œë³„ ê²½ê¸° ì„ íƒ â†’ ì±„íŒ…ì°½ì— ë¶„ì„ê¸€ ë©”ì‹œì§€ë¡œ ë³´ë‚´ê¸°
    if data.startswith("match:"):
        _, sport, match_id = data.split(":", 2)
        items = ANALYSIS_DATA.get(sport, [])

        title = "ì„ íƒí•œ ê²½ê¸°"
        summary = "í•´ë‹¹ ê²½ê¸° ë¶„ì„ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."

        for item in items:
            if item["id"] == match_id:
                title = item["title"]
                summary = item["summary"]
                break

        text = f"ğŸ“Œ ê²½ê¸° ë¶„ì„ â€“ {title}\n\n{summary}"

        # ë¶„ì„ ê¸€ ì•„ë˜ì— ë²„íŠ¼ 2ê°œ ë‹¬ê¸°
        buttons = [
            [InlineKeyboardButton("ğŸ“ ë¶„ì„ê¸€ ë” ë³´ê¸°", callback_data="analysis_root")],
            [InlineKeyboardButton("â—€ ë©”ì¸ ë©”ë‰´ë¡œ", callback_data="back_main")],
        ]

        await q.message.reply_text(
            text,
            reply_markup=InlineKeyboardMarkup(buttons),
        )
        return


    # ê¸ˆì¼ ìŠ¤í¬ì¸  ì •ë³´ ë£¨íŠ¸: ë‰´ìŠ¤ ë¦¬ìŠ¤íŠ¸
    if data == "news_root":
        await q.edit_message_reply_markup(reply_markup=build_news_list_menu())
        return

    # âœ… ë‰´ìŠ¤ ì œëª© í´ë¦­ â†’ ì±„íŒ…ì°½ì— ìš”ì•½ ë©”ì‹œì§€ë¡œ ë³´ë‚´ê¸°
    if data.startswith("news_item:"):
        try:
            idx = int(data.split(":", 1)[1])
            item = NEWS_ITEMS[idx]
            title = item["title"]
            summary = item["summary"]
        except Exception:
            title = "ë‰´ìŠ¤ ì •ë³´ ì—†ìŒ"
            summary = "í•´ë‹¹ ë‰´ìŠ¤ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."

        text = f"ğŸ“° ë‰´ìŠ¤ ìš”ì•½ â€“ {title}\n\n{summary}"

        buttons = [
            [InlineKeyboardButton("ğŸ“° ë‹¤ë¥¸ ë‰´ìŠ¤ ë³´ê¸°", callback_data="news_root")],
            [InlineKeyboardButton("â—€ ë©”ì¸ ë©”ë‰´ë¡œ", callback_data="back_main")],
        ]

        await q.message.reply_text(
            text,
            reply_markup=InlineKeyboardMarkup(buttons),
        )
        return




# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ì‹¤í–‰ë¶€ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

def main():
    app = ApplicationBuilder().token(TOKEN).build()

    # 1:1 í…ŒìŠ¤íŠ¸ìš©
    app.add_handler(CommandHandler("start", start))
    app.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, on_text))

    # ì±„ë„ ë©”ë‰´ìš©
    app.add_handler(CommandHandler("publish", publish))
    app.add_handler(CallbackQueryHandler(on_callback))

    port = int(os.environ.get("PORT", "10000"))
    app.run_webhook(
        listen="0.0.0.0",
        port=port,
        url_path=TOKEN,
        webhook_url=f"{APP_URL}/{TOKEN}",
    )


if __name__ == "__main__":
    main()














